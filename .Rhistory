stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 17, size = .75) +
geom_point2(size = 3, alpha = 0.4, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
cposplot2
cposplot2 <- ggplot(cartregen2, aes(Position, perc_cartregen_length, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 17, size = .75) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
cposplot2
cposplot2 <- ggplot(cartregen2, aes(Position, perc_cartregen_length, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 3, size = .75) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
cposplot2
cposplot2 <- ggplot(cartregen2, aes(Position, perc_cartregen_length, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 6, size = .75) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
cposplot2
cposplot2 <- ggplot(cartregen2, aes(Position, perc_cartregen_length, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = .75) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
cposplot2
cposplot2 <- ggplot(cartregen2, aes(Position, perc_cartregen_length, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
cposplot2
ccountplot <- ggplot(cartregen_means, aes(AgeCat, mean_count)) +
geom_bar_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black",
color = "black", fun = "mean", stat = "summary") +
stat_summary(geom = "errorbar", fun.data = mean_se, width = 0.25) +
#geom_point2(size = 4, alpha = 0.6) +
ylab("Mean Number of \nCartilage Pieces in ROI") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
scale_pattern_type_manual(values = c("hexagonal", "none", "none", "none", "none")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
ccountplot
ggsave("Figures/CartilageCount.png", dpi=300, width=180, height=90, unit="mm")
ccountplot <- ggplot(cartregen_means, aes(AgeCat, mean_count)) +
geom_bar_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black",
color = "black", fun = "mean", stat = "summary", alpha = 0.8) +
stat_summary(geom = "errorbar", fun.data = mean_se, width = 0.25) +
geom_point2(size = 3, alpha = 0.6, color = "black") +
ylab("Mean Number of \nCartilage Pieces in ROI") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
scale_pattern_type_manual(values = c("hexagonal", "none", "none", "none", "none")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
ccountplot
ccountplot <- ggplot(cartregen_means, aes(AgeCat, mean_count)) +
geom_bar_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "lightgrey",
color = "black", fun = "mean", stat = "summary", alpha = 0.8) +
stat_summary(geom = "errorbar", fun.data = mean_se, width = 0.25) +
geom_point2(size = 3, alpha = 0.6, color = "black") +
ylab("Mean Number of \nCartilage Pieces in ROI") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
scale_pattern_type_manual(values = c("hexagonal", "none", "none", "none", "none")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
ccountplot
ggsave("Figures/CartilageCount.png", dpi=300, width=180, height=90, unit="mm")
ccountposplot <- ggplot(cartregen2, aes(AgeCat, Count.x, fill = Position_Age)) +
geom_boxplot(alpha = 0.85) +
#geom_bar(fun = "median", stat="summary", position = "dodge", color = "black", alpha = 0.85) +
#stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge") +
#geom_point2(size = 2, alpha = 0.5, position = position_dodge(width=.9)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(0,2,4,6,8,10,12)) +
ylab("Number of \nCartilage Pieces in ROI") + xlab("") +
guides(color = "none") +
scale_fill_manual(values = c("#440154", "#e57efd", "#f5cbfe",
"#5ec962", "#99dd9b", "#d4f0d5",
"#21918c", "#90e6e2", "#d0f4f3",
"#3b528b", "#a0b0d7", "#d7deee")) +
theme_cowplot() + theme(legend.position = "none")
ccountposplot
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, color = "black", position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
#stat_summary(fun.min = function(z) { quantile(z,0.25) },
#fun.max = function(z) { quantile(z,0.75) },
#fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
#stat_summary(fun.min = function(z) { quantile(z,0.25) },
#fun.max = function(z) { quantile(z,0.75) },
#fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
#geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
#geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
plot_grid(cmeansplot, cposplot2,
ccountplot, ccountposplot2,
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
ggsave("Figures/CartilagePanel.png", dpi = 300, width = 180, height = 210, unit = "mm")
#for final figures
library(extrafont)
font_import()
loadfonts()
plot_grid(cmeansplot, cposplot2,
ccountplot, ccountposplot2,
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
ggsave("Figures/CartilagePanel.png", dpi = 300, width = 180, height = 210, unit = "mm")
acountplot <- ggplot(adipo_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "lightgrey", color = "black", alpha = 0.8)+
geom_point2(size = 3, alpha = 0.6, color = "black") +
ylab("Mean Number of Adipocytes \nper 100µM") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12,14,16,18,20), limits = c(0,20)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
acountplot
adipo_means <- adipo_means %>%
mutate(AgeCat2 = case_when(AgeCat == "Uninj. Tissue" ~ 1,
AgeCat == "3-4mo" ~ 0,
AgeCat == "4-6mo" ~ 0,
AgeCat == "6-9mo" ~ 0,
AgeCat == "≥ 22mo" ~ 0))
acountplot <- ggplot(adipo_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "lightgrey", color = "black", alpha = 0.8)+
geom_point2(size = 3, alpha = 0.6, color = "black") +
ylab("Mean Number of Adipocytes \nper 100µM") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12,14,16,18,20), limits = c(0,20)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
acountplot
ggsave("Figures/AdipoCount.png", dpi=300, width=180, height=90, unit="mm")
adiporegen2 <- adiporegen %>%
mutate(Position = case_when(Slide_per <= 33.333 ~ "Proximal",
Slide_per > 33.333 & Slide_per < 66.666 ~ "Middle",
Slide_per >= 66.666 ~ "Distal")) %>%
filter(AgeCat != "Uninj. Tissue") %>%
mutate(Position_Age = paste(AgeCat, Position, sep = "-")) %>%
mutate(Position2 = case_when(Position == "Proximal" ~ 1,
Position == "Middle" ~ 2,
Position == "Distal" ~ 3))
adiporegen2$Position <- factor(adiporegen2$Position, levels = c("Proximal", "Middle", "Distal"))
aposplot2 <- ggplot(adiporegen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Adipocytes \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
aposplot2
aposplot2 <- ggplot(adiporegen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, color = "black") +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Adipocytes \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
aposplot2
aposplot2 <- ggplot(adiporegen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Adipocytes \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
aposplot2
aposplot2 <- ggplot(adiporegen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Adipocytes \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
aposplot2
, size = 1
aposplot2 <- ggplot(adiporegen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Adipocytes \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
aposplot2
muscle_means <- muscle_means %>%
mutate(AgeCat2 = case_when(AgeCat == "Uninj. Tissue" ~ 1,
AgeCat == "3-4mo" ~ 0,
AgeCat == "4-6mo" ~ 0,
AgeCat == "6-9mo" ~ 0,
AgeCat == "≥ 22mo" ~ 0))
mcountplot <- ggplot(muscle_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black", color = "black")+
ylab("Mean Number of Muscle Fibers \nper 100µM") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
#scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12,14,16,18,20), limits = c(0,20)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
mcountplot
mcountplot <- ggplot(muscle_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "lightgrey", color = "black", alpha = 0.8) +
geom_point2(size = 3, alpha = 0.6, color = "black") +
ylab("Mean Number of Muscle Fibers \nper 100µM") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
#scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12,14,16,18,20), limits = c(0,20)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
mcountplot
ggsave("Figures/MuscleCount.png", dpi=300, width=180, height=90, unit="mm")
muscleregen2 <- muscleregen %>%
mutate(Position = case_when(Slide_per <= 33.333 ~ "Proximal",
Slide_per > 33.333 & Slide_per < 66.666 ~ "Middle",
Slide_per >= 66.666 ~ "Distal")) %>%
filter(AgeCat != "Uninj. Tissue") %>%
mutate(Position_Age = paste(AgeCat, Position, sep = "-")) %>%
mutate(Position2 = case_when(Position == "Proximal" ~ 1,
Position == "Middle" ~ 2,
Position == "Distal" ~ 3))
muscleregen2$Position <- factor(muscleregen2$Position, levels = c("Proximal", "Middle", "Distal"))
mposplot3 <- ggplot(muscleregen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
ylab("Median Number of Muscle Fibers \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
mposplot3
mposplot3 <- ggplot(muscleregen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4),
shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6) +
ylab("Median Number of Muscle Fibers \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
mposplot3
mposplot3 <- ggplot(muscleregen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4),
shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
ylab("Median Number of Muscle Fibers \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
mposplot3
hairs_means <- hairs_means %>%
mutate(AgeCat2 = case_when(AgeCat == "Uninj. Tissue" ~ 1,
AgeCat == "3-4mo" ~ 0,
AgeCat == "4-6mo" ~ 0,
AgeCat == "6-9mo" ~ 0,
AgeCat == "≥ 22mo" ~ 0))
hcountplot <- ggplot(hairs_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "lightgrey", color = "black", alpha = 0.8)+
geom_point2(size = 3, alpha = 0.6, color = "black")
hcountplot <- ggplot(hairs_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "lightgrey", color = "black", alpha = 0.8)+
geom_point2(size = 3, alpha = 0.6, color = "black") +
ylab("Mean Number of Hairs \nper 100µM") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
#scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12,14,16,18,20), limits = c(0,20)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
hcountplot
hairregen2 <- hairregen %>%
mutate(Position = case_when(Slide_per <= 33.333 ~ "Proximal",
Slide_per > 33.333 & Slide_per < 66.666 ~ "Middle",
Slide_per >= 66.666 ~ "Distal")) %>%
filter(AgeCat != "Uninj. Tissue") %>%
mutate(Position_Age = paste(AgeCat, Position, sep = "-")) %>%
mutate(Position2 = case_when(Position == "Proximal" ~ 1,
Position == "Middle" ~ 2,
Position == "Distal" ~ 3))
hairregen2$Position <- factor(hairregen2$Position, levels = c("Proximal", "Middle", "Distal"))
hposplot2 <- ggplot(hairregen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Hairs \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
hposplot2
hposplot2 <- ggplot(hairregen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4),
shape = 15, size = 1) +
geom_point2(size = 3, alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Hairs \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
hposplot2
plot_grid(acountplot, aposplot2 + theme(legend.position = "none"),
mcountplot, mposplot3 + theme(legend.position = "none"),
hcountplot, hposplot2 + theme(legend.position = "none"),
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
ggsave("Figures/AMHPanel.png", dpi = 300, width = 180, height = 210, unit = "mm")
aposplot2 <- ggplot(adiporegen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15, size = 1) +
geom_point2(alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Adipocytes \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
aposplot2
aposplot2 <- ggplot(adiporegen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4), shape = 15) +
geom_point2(alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Adipocytes \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
aposplot2
plot_grid(acountplot, aposplot2 + theme(legend.position = "none"),
mcountplot, mposplot3 + theme(legend.position = "none"),
hcountplot, hposplot2 + theme(legend.position = "none"),
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
ggsave("Figures/AMHPanel.png", dpi = 300, width = 180, height = 210, unit = "mm")
mposplot3 <- ggplot(muscleregen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4),
shape = 15) +
geom_point2(alpha = 0.6, position = position_dodge(width = 0.4)) +
ylab("Median Number of Muscle Fibers \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
mposplot3
hposplot2 <- ggplot(hairregen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.4), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.4),
shape = 15) +
geom_point2(alpha = 0.6, position = position_dodge(width = 0.4)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Hairs \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
hposplot2
plot_grid(acountplot, aposplot2 + theme(legend.position = "none"),
mcountplot, mposplot3 + theme(legend.position = "none"),
hcountplot, hposplot2 + theme(legend.position = "none"),
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
ggsave("Figures/AMHPanel.png", dpi = 300, width = 180, height = 210, unit = "mm")
