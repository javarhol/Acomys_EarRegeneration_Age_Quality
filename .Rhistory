library(ggsci)
library(see)
library(ggpattern)
library(stringr)
library(readxl)
library(easystats)
library(lme4)
library(lmerTest)
measures <- read_excel("data/measurements_020924.xlsx")
daystoclose <- read.csv("data/EarDaysToClose_Data.csv")
muscle <- read.csv("data/muscle.csv")
hairs <- read_excel("data/hairfollicles.xlsx")
measures <- measures %>%
select(AnimalID, Slide, Name, Num.points, Length_microm) %>%
left_join(daystoclose[,c(2,3,7,8)]) %>%
mutate(AgeInMonths = (AgeAtInjury/30.417))
measures$AgeCat[is.na(measures$AgeCat)] <- "Uninj. Tissue"
measures$AgeCat <- factor(measures$AgeCat, levels = c("Uninj. Tissue", "3-4mo", "4-6mo", "6-9mo", "≥ 22mo"))
muscle <- muscle %>%
filter(uninj.muscle == 1)
##Count the number of slides per animalid,
slidecount <- measures %>%
filter(Name == "Regenerated Length") %>%
group_by(AnimalID) %>%
summarise(slidecount = n())
#assign a count to each slide number,
measures1 <- left_join(measures, slidecount, by = "AnimalID")
#divide count by number of slides per animal id,
slidenumber <- measures1 %>%
filter(Name == "Regenerated Length") %>%
group_by(AnimalID) %>%
mutate(Slide_adj = rank(Slide)) %>%
select(AnimalID, Slide, Slide_adj, slidecount) %>%
unique() %>%
mutate(Slide_per = 100*(Slide_adj/slidecount))
measures2 <- left_join(measures1, slidenumber, by = c("AnimalID", "Slide", "slidecount"))
cartilage <- measures2 %>%
filter(Name == "Cartilage Length") %>%
group_by(AnimalID, Slide, Slide_per, Sex, AgeInMonths, AgeCat, Name) %>%
summarise(Length = sum(Length_microm), Count = n())
#summarise(Area = sum(Area.µm.2), Perimeter = sum(Perimeter.µm))
regenarea <- measures2 %>%
filter(Name == "Regenerated Length") %>%
group_by(AnimalID, Slide, Slide_per, Sex, AgeInMonths, AgeCat, Name) %>%
summarise(Length = sum(Length_microm), Count = n())
adipocytes <- measures2 %>%
filter(Name == "Adipocytes") %>%
group_by(AnimalID, Slide, Slide_per, Sex, AgeInMonths, AgeCat, Name) %>%
summarise(count = sum(Num.points))
cartregen <- cartilage %>%
left_join(regenarea, by = c("AnimalID", "Slide", "Slide_per", "Sex", "AgeInMonths", "AgeCat")) %>%
mutate(perc_cartregen_length = 100*(Length.x / Length.y))
adiporegen <- adipocytes %>%
left_join(regenarea, by = c("AnimalID", "Slide", "Slide_per", "Sex", "AgeInMonths", "AgeCat")) %>%
mutate(count_area = count / (Length/100))
cartregen$AnimalID_Slide <- paste(cartregen$AnimalID, cartregen$Slide, sep = "-")
muscleregen <- muscle %>%
left_join(regenarea, by = c("AnimalID", "Slide")) %>%
mutate(count_area = fiber.count / (Length/100)) %>%
filter(!is.na(count_area))#############lots of NA values, why?
hairregen <- hairs %>%
left_join(regenarea, by = c("AnimalID", "Slide")) %>%
mutate(count_area = Num.points / (Length/100)) %>%
filter(!is.na(count_area))#############lots of NA values, why?
cartregen_means <- cartregen %>%
group_by(AnimalID, AgeCat) %>%
summarise(mean_perc_cartregen_length = mean(perc_cartregen_length), mean_count=mean(Count.x))
adipo_means <- adiporegen %>%
group_by(AnimalID, AgeCat) %>%
summarise(mean_count_area=mean(count_area), mean_count=mean(count))
muscle_means <- muscleregen %>%
group_by(AnimalID, AgeCat) %>%
summarise(mean_count_area=mean(count_area), mean_count=mean(fiber.count))
hairs_means <- hairregen %>%
group_by(AnimalID, AgeCat) %>%
summarise(mean_count_area=mean(count_area), mean_count=mean(Num.points))
View(cartregen_means)
View(cartregen)
View(muscle_means)
View(daystoclose)
?ggsave()
ggplot(areaperday1, aes(DayPostWounding, Area, fill=AgeinMonths))+
geom_point(size = 3, pch = 21, color = "black") +
scale_x_continuous(breaks=seq(0,110, 5))+
geom_hline(yintercept=12.56637061, linetype="dashed", color="black")+
xlab("days post injury") + ylab(bquote("Area "(mm^2)))+
labs(fill="Age \nin Months")+
theme_cowplot()+
scale_fill_gradient2(low = "#fde725", mid = "#22A884", high = "#414487", midpoint = 6) +
theme(base_size = 9, axis.text.x=element_text(angle=90, vjust=0.75))
daystoclose <- read.csv("data/EarDaysToClose_Data.csv")
areaperday <- read.csv("data/EarAreaPerDay_Data.csv")
areaperday <- left_join(areaperday, daystoclose, by="AnimalID")
#animals to exclude due to insufficient data
exclude <- c("925878-1", "925878-2", "1001363-1", "1001363-2", "990342-1", "990342-2")
areaperday1 <- filter(areaperday, !AnimalID %in% exclude)
areaperday1 <- filter(areaperday1, !DayPostWounding %in% c(0))
areaperday1 <- mutate(areaperday1, AgeinMonths=(AgeAtInjury/30.417))
ggplot(areaperday1, aes(DayPostWounding, Area, color=AgeinMonths))+
geom_point2(size = 3, alpha = 0.5) +
scale_x_continuous(breaks=seq(0,110, 5))+
geom_hline(yintercept=12.56637061, linetype="dashed", color="black")+
xlab("days post injury") + ylab(bquote("Area "(mm^2)))+
labs(color="Age \nin Months")+
theme_cowplot()+
scale_color_gradient2(low = "#5ec962", mid = "#21918c", high = "#3b528b", midpoint = 6) +
theme(axis.text.x=element_text(angle=90, vjust=0.75))
ggplot(areaperday1, aes(DayPostWounding, Area, fill=AgeinMonths))+
geom_point(size = 3, pch = 21, color = "black") +
scale_x_continuous(breaks=seq(0,110, 5))+
geom_hline(yintercept=12.56637061, linetype="dashed", color="black")+
xlab("days post injury") + ylab(bquote("Area "(mm^2)))+
labs(fill="Age \nin Months")+
theme_cowplot()+
scale_fill_gradient2(low = "#fde725", mid = "#22A884", high = "#414487", midpoint = 6) +
theme(base_size = 9, axis.text.x=element_text(angle=90, vjust=0.75))
ggplot(areaperday1, aes(DayPostWounding, Area, fill=AgeinMonths))+
geom_point(size = 3, pch = 21, color = "black") +
scale_x_continuous(breaks=seq(0,110, 5))+
geom_hline(yintercept=12.56637061, linetype="dashed", color="black")+
xlab("days post injury") + ylab(bquote("Area "(mm^2)))+
labs(fill="Age \nin Months")+
theme_cowplot(base_size = 9)+
scale_fill_gradient2(low = "#fde725", mid = "#22A884", high = "#414487", midpoint = 6) +
theme(axis.text.x=element_text(angle=90, vjust=0.75))
ggplot(areaperday1, aes(DayPostWounding, Area, fill=AgeinMonths))+
geom_point(size = 3, pch = 21, color = "black") +
scale_x_continuous(breaks=seq(0,110, 5))+
geom_hline(yintercept=12.56637061, linetype="dashed", color="black")+
xlab("days post injury") + ylab(bquote("Area "(mm^2)))+
labs(fill="Age \nin Months")+
theme_cowplot(font_size = 9)+
scale_fill_gradient2(low = "#fde725", mid = "#22A884", high = "#414487", midpoint = 6) +
theme(axis.text.x=element_text(angle=90, vjust=0.75))
ggplot(areaperday1, aes(DayPostWounding, Area, fill=AgeinMonths))+
geom_point(size = 3, pch = 21, color = "black") +
scale_x_continuous(breaks=seq(0,110, 5))+
geom_hline(yintercept=12.56637061, linetype="dashed", color="black")+
xlab("days post injury") + ylab(bquote("Area "(mm^2)))+
labs(fill="Age \nin Months")+
theme_cowplot(font_size = 8)+
scale_fill_gradient2(low = "#fde725", mid = "#22A884", high = "#414487", midpoint = 6) +
theme(axis.text.x=element_text(angle=90, vjust=0.75))
ggsave("Figures/EarClose_Time_Age_viridis.pdf", dpi=300, width=180, height=90, unit="mm")
ggplot(areaperday1, aes(DayPostWounding, Area, fill=AgeinMonths))+
geom_point(size = 1, pch = 21, color = "black") +
scale_x_continuous(breaks=seq(0,110, 5))+
geom_hline(yintercept=12.56637061, linetype="dashed", color="black")+
xlab("days post injury") + ylab(bquote("Area "(mm^2)))+
labs(fill="Age \nin Months")+
theme_cowplot(font_size = 8)+
scale_fill_gradient2(low = "#fde725", mid = "#22A884", high = "#414487", midpoint = 6) +
theme(axis.text.x=element_text(angle=90, vjust=0.75))
ggplot(areaperday1, aes(DayPostWounding, Area, fill=AgeinMonths))+
geom_point(size = 2, pch = 21, color = "black") +
scale_x_continuous(breaks=seq(0,110, 5))+
geom_hline(yintercept=12.56637061, linetype="dashed", color="black")+
xlab("days post injury") + ylab(bquote("Area "(mm^2)))+
labs(fill="Age \nin Months")+
theme_cowplot(font_size = 8)+
scale_fill_gradient2(low = "#fde725", mid = "#22A884", high = "#414487", midpoint = 6) +
theme(axis.text.x=element_text(angle=90, vjust=0.75))
ggsave("Figures/EarClose_Time_Age_viridis.pdf", dpi=300, width=180, height=90, unit="mm")
cartregen_means <- cartregen_means %>%
mutate(AgeCat2 = case_when(AgeCat == "Uninj. Tissue" ~ 1,
AgeCat == "3-4mo" ~ 0,
AgeCat == "4-6mo" ~ 0,
AgeCat == "6-9mo" ~ 0,
AgeCat == "≥ 22mo" ~ 0))
cmeansplot <- ggplot(cartregen_means, aes(AgeCat, mean_perc_cartregen_length)) +
geom_bar_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black",
color = "black", fun = "mean", stat = "summary") +
#geom_bar(fun = "mean", stat="summary", color = "black", alpha = 0.85) +
stat_summary(geom = "errorbar", fun.data = mean_se, width = 0.25) +
#geom_point2(size = 4, alpha = 0.6) +
ylab("Mean % Cartilage in ROI") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,100), labels=function(x) paste0(x,"%")) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
scale_pattern_type_manual(values = c("hexagonal", "none", "none", "none", "none")) +
theme_cowplot() +
theme(legend.position = "none")
cmeansplot
#ggsave("Figures/CartilagePercent.png", dpi=300, width=180, height=90, unit="mm")
#ggsave("Figures/CartilagePercent.eps", dpi=300, width=180, height=90, unit="mm")
cmeansplot <- ggplot(cartregen_means, aes(AgeCat, mean_perc_cartregen_length)) +
geom_bar_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black",
color = "black", fun = "mean", stat = "summary") +
#geom_bar(fun = "mean", stat="summary", color = "black", alpha = 0.85) +
stat_summary(geom = "errorbar", fun.data = mean_se, width = 0.25) +
#geom_point2(size = 4, alpha = 0.6) +
ylab("Mean % Cartilage in ROI") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,100), labels=function(x) paste0(x,"%")) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
scale_pattern_type_manual(values = c("hexagonal", "none", "none", "none", "none")) +
theme_cowplot(font_size = 8) +
theme(legend.position = "none")
cmeansplot
cartregen2 <- cartregen %>%
mutate(Position = case_when(Slide_per <= 33.333 ~ "Proximal",
Slide_per > 33.333 & Slide_per < 66.666 ~ "Middle",
Slide_per >= 66.666 ~ "Distal")) %>%
mutate(Position_Age = paste(AgeCat, Position, sep = "-")) %>%
filter(AgeCat != "Uninj. Tissue")
cartregen2$Position <- factor(cartregen2$Position, levels = c("Proximal", "Middle", "Distal"))
cartregen2$Position_Age <- factor(cartregen2$Position_Age, levels = c("≥ 22mo-Proximal", "≥ 22mo-Middle", "≥ 22mo-Distal",
"3-4mo-Proximal", "3-4mo-Middle", "3-4mo-Distal",
"4-6mo-Proximal", "4-6mo-Middle", "4-6mo-Distal",
"6-9mo-Proximal", "6-9mo-Middle", "6-9mo-Distal"))
#supplemental graph
cposplot <- ggplot(cartregen2, aes(AgeCat, perc_cartregen_length)) +
geom_boxplot_pattern(aes(pattern_density = Position, fill = AgeCat),
pattern = "circle", pattern_spacing = 0.02, pattern_fill = "black", color = "black") +
#geom_bar(fun = "mean", stat="summary", position = "dodge", color = "black", alpha = 0.85) +
#stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge") +
#geom_point2(size = 2, alpha = 0.5, position = position_dodge(width=.9)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI") + xlab("") +
guides(color = "none") +
scale_fill_manual(values = c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot() + theme(legend.position = "none")
cposplot
cposplot2 <- ggplot(cartregen2, aes(Position, perc_cartregen_length, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot() + theme(legend.position = "none")
cposplot2
cposplot2 <- ggplot(cartregen2, aes(Position, perc_cartregen_length, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8) + theme(legend.position = "none")
cposplot2 <- ggplot(cartregen2, aes(Position, perc_cartregen_length, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,110), breaks = c(0, 25, 50, 75, 100), labels=function(x) paste0(x,"%")) +
ylab("% Cartilage in ROI")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
cposplot2
cmeansplot <- ggplot(cartregen_means, aes(AgeCat, mean_perc_cartregen_length)) +
geom_bar_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black",
color = "black", fun = "mean", stat = "summary") +
#geom_bar(fun = "mean", stat="summary", color = "black", alpha = 0.85) +
stat_summary(geom = "errorbar", fun.data = mean_se, width = 0.25) +
#geom_point2(size = 4, alpha = 0.6) +
ylab("Mean % Cartilage in ROI") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), limits=c(0,100), labels=function(x) paste0(x,"%")) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
scale_pattern_type_manual(values = c("hexagonal", "none", "none", "none", "none")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
cmeansplot
ccountplot <- ggplot(cartregen_means, aes(AgeCat, mean_count)) +
geom_bar_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black",
color = "black", fun = "mean", stat = "summary") +
stat_summary(geom = "errorbar", fun.data = mean_se, width = 0.25) +
#geom_point2(size = 4, alpha = 0.6) +
ylab("Mean Number of \nCartilage Pieces in ROI") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
scale_pattern_type_manual(values = c("hexagonal", "none", "none", "none", "none")) +
theme_cowplot() +
theme(legend.position = "none")
ccountplot
ccountplot <- ggplot(cartregen_means, aes(AgeCat, mean_count)) +
geom_bar_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black",
color = "black", fun = "mean", stat = "summary") +
stat_summary(geom = "errorbar", fun.data = mean_se, width = 0.25) +
#geom_point2(size = 4, alpha = 0.6) +
ylab("Mean Number of \nCartilage Pieces in ROI") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
scale_pattern_type_manual(values = c("hexagonal", "none", "none", "none", "none")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
ccountplot
ccountposplot2 <- ggplot(cartregen2, aes(Position, Count.x, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12), limits = c(0,12)) +
ylab("Number of \nCartilage Pieces in ROI")  + xlab("") + labs(color = "Age \nat Injury", shape = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") + theme(legend.position = "none")
ccountposplot2
plot_grid(cmeansplot, cposplot2,
ccountplot, ccountposplot2,
ncol = 2, labels = "AUTO")
install.packages('pak')
pak::pak('r-lib/ragg')
install.packages('ragg')
plot_grid(cmeansplot, cposplot2,
ccountplot, ccountposplot2,
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggbeeswarm)
library(cowplot)
library(ggsci)
library(see)
library(ggpattern)
library(stringr)
library(readxl)
library(easystats)
library(lme4)
library(lmerTest)
plot_grid(cmeansplot, cposplot2,
ccountplot, ccountposplot2,
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
install.packages("showtext")
library(showtext)
font_add_google("Arial", family = "Arial")
install.packages("extrafont")
library(extrafont)
font_import()
loadfonts()
plot_grid(cmeansplot, cposplot2,
ccountplot, ccountposplot2,
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
ggsave("Figures/CartilagePanel.pdf", dpi = 300, width = 280, height = 210, unit = "mm")
ng
ggsave("Figures/CartilagePanel.png", dpi = 300, width = 280, height = 210, unit = "mm")
ggsave("Figures/CartilagePanel.png", dpi = 300, width = 180, height = 210, unit = "mm")
adipo_means <- adipo_means %>%
mutate(AgeCat2 = case_when(AgeCat == "Uninj. Tissue" ~ 1,
AgeCat == "3-4mo" ~ 0,
AgeCat == "4-6mo" ~ 0,
AgeCat == "6-9mo" ~ 0,
AgeCat == "≥ 22mo" ~ 0))
acountplot <- ggplot(adipo_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black", color = "black")+
ylab("Mean Number of Adipocytes \nper 100µM") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12,14,16,18,20), limits = c(0,20)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
acountplot
adiporegen2 <- adiporegen %>%
mutate(Position = case_when(Slide_per <= 33.333 ~ "Proximal",
Slide_per > 33.333 & Slide_per < 66.666 ~ "Middle",
Slide_per >= 66.666 ~ "Distal")) %>%
filter(AgeCat != "Uninj. Tissue") %>%
mutate(Position_Age = paste(AgeCat, Position, sep = "-")) %>%
mutate(Position2 = case_when(Position == "Proximal" ~ 1,
Position == "Middle" ~ 2,
Position == "Distal" ~ 3))
adiporegen2$Position <- factor(adiporegen2$Position, levels = c("Proximal", "Middle", "Distal"))
aposplot <- ggplot(adiporegen2, aes(AgeCat, count_area, fill = Position_Age)) +
geom_boxplot(alpha = 0.85) +
#geom_bar(fun = "median", stat="summary", position = "dodge", color = "black", alpha = 0.85) +
#stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge") +
#geom_point2(size = 2, alpha = 0.5, position = position_dodge(width=.9)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Mean Number of Adipocytes \nper 100µM")  + xlab("") +
guides(color = "none") +
scale_fill_manual(values = c("#440154", "#e57efd", "#f5cbfe",
"#5ec962", "#99dd9b", "#d4f0d5",
"#21918c", "#90e6e2", "#d0f4f3",
"#3b528b", "#a0b0d7", "#d7deee")) +
theme_cowplot() + theme(legend.position = "none")
aposplot
aposplot2 <- ggplot(adiporegen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Adipocytes \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot()
aposplot2 <- ggplot(adiporegen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Adipocytes \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
aposplot2
muscle_means <- muscle_means %>%
mutate(AgeCat2 = case_when(AgeCat == "Uninj. Tissue" ~ 1,
AgeCat == "3-4mo" ~ 0,
AgeCat == "4-6mo" ~ 0,
AgeCat == "6-9mo" ~ 0,
AgeCat == "≥ 22mo" ~ 0))
mcountplot <- ggplot(muscle_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black", color = "black")+
ylab("Mean Number of Muscle Fibers \nper 100µM") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
#scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12,14,16,18,20), limits = c(0,20)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
mcountplot
muscleregen2 <- muscleregen %>%
mutate(Position = case_when(Slide_per <= 33.333 ~ "Proximal",
Slide_per > 33.333 & Slide_per < 66.666 ~ "Middle",
Slide_per >= 66.666 ~ "Distal")) %>%
filter(AgeCat != "Uninj. Tissue") %>%
mutate(Position_Age = paste(AgeCat, Position, sep = "-")) %>%
mutate(Position2 = case_when(Position == "Proximal" ~ 1,
Position == "Middle" ~ 2,
Position == "Distal" ~ 3))
muscleregen2$Position <- factor(muscleregen2$Position, levels = c("Proximal", "Middle", "Distal"))
mposplot <- ggplot(muscleregen2, aes(AgeCat, count_area, fill = Position_Age)) +
geom_boxplot(alpha = 0.85) +
#geom_bar(fun = "median", stat="summary", position = "dodge", color = "black", alpha = 0.85) +
#stat_summary(geom = "errorbar", fun.data = mean_se, position = "dodge") +
#geom_point2(size = 2, alpha = 0.5, position = position_dodge(width=.9)) +
ylab("Mean Number of Muscle Fibers \nper 100µM")  + xlab("") +
guides(color = "none") +
scale_fill_manual(values = c("#440154", "#e57efd", "#f5cbfe",
"#5ec962", "#99dd9b", "#d4f0d5",
"#21918c", "#90e6e2", "#d0f4f3",
"#3b528b", "#a0b0d7", "#d7deee")) +
theme_cowplot() + theme(legend.position = "none")
mposplot
mposplot3 <- ggplot(muscleregen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
ylab("Median Number of Muscle Fibers \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
mposplot3
hairs_means <- hairs_means %>%
mutate(AgeCat2 = case_when(AgeCat == "Uninj. Tissue" ~ 1,
AgeCat == "3-4mo" ~ 0,
AgeCat == "4-6mo" ~ 0,
AgeCat == "6-9mo" ~ 0,
AgeCat == "≥ 22mo" ~ 0))
hcountplot <- ggplot(hairs_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black", color = "black")+
ylab("Mean Number of Hairs \nper 100µM") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
#scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12,14,16,18,20), limits = c(0,20)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot() +
theme(legend.position = "none")
hcountplot <- ggplot(hairs_means, aes(AgeCat, mean_count_area)) +
geom_boxplot_pattern(aes(pattern_density = AgeCat2, fill = AgeCat),
pattern = "stripe", pattern_spacing = 0.02, pattern_fill = "black", color = "black")+
ylab("Mean Number of Hairs \nper 100µM") + xlab("") +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
#scale_y_continuous(expand = expansion(mult = c(0, 0.05)), breaks = c(2,4,6,8,10,12,14,16,18,20), limits = c(0,20)) +
scale_fill_manual(values=c("white", "#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial") +
theme(legend.position = "none")
hcountplot
hairregen2 <- hairregen %>%
mutate(Position = case_when(Slide_per <= 33.333 ~ "Proximal",
Slide_per > 33.333 & Slide_per < 66.666 ~ "Middle",
Slide_per >= 66.666 ~ "Distal")) %>%
filter(AgeCat != "Uninj. Tissue") %>%
mutate(Position_Age = paste(AgeCat, Position, sep = "-")) %>%
mutate(Position2 = case_when(Position == "Proximal" ~ 1,
Position == "Middle" ~ 2,
Position == "Distal" ~ 3))
hairregen2$Position <- factor(hairregen2$Position, levels = c("Proximal", "Middle", "Distal"))
hposplot2 <- ggplot(hairregen2, aes(Position, count_area, color = AgeCat, group = AgeCat)) +
stat_summary(geom = "line", fun = "median", position = position_dodge(width = 0.2), linetype = "dashed") +
stat_summary(fun.min = function(z) { quantile(z,0.25) },
fun.max = function(z) { quantile(z,0.75) },
fun = median, position = position_dodge(width = 0.2)) +
scale_y_continuous(expand = expansion(mult = c(0, 0.05))) +
ylab("Median Number of Hairs \nper 100µM")  + xlab("") + labs(color = "Age \nat Injury") +
scale_color_manual(values=c("#FDE725", "#22A884", "#414487", "#440154")) +
theme_cowplot(font_size = 8, font_family = "Arial")
hposplot2
plot_grid(acountplot + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)), aposplot2 + theme(legend.position = "none"),
mcountplot + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)), mposplot3 + theme(legend.position = "none"),
hcountplot + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)), hposplot2 + theme(legend.position = "none"),
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
ggsave("Figures/AMHPanel.png", dpi = 300, width = 180, height = 210, unit = "mm")
plot_grid(acountplot, aposplot2 + theme(legend.position = "none"),
mcountplot, mposplot3 + theme(legend.position = "none"),
hcountplot, hposplot2 + theme(legend.position = "none"),
ncol = 2, labels = "AUTO",
label_size = 12, label_fontfamily = "Arial", label_fontface = "bold")
ggsave("Figures/AMHPanel.png", dpi = 300, width = 180, height = 210, unit = "mm")
